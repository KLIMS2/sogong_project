<html layout:decorate="~{layout/layout.html}">
    <body>
        <section layout:fragment="content">
            <h1>board create</h1>

            <form th:action="@{/board/create}"
                  method="post"
                  onsubmit="checkForm(this); return false;"
                  th:object="${boardForm}"
                  class="flex flex-col gap-2">
                <div class="flex flex-col">
                    <label for="title">게시판 이름</label>
                    <input type="text"
                           th:field="*{title}"
                           placeholder="게시판 이름"
                           class="input"/>
                </div>
                <div th:replace="~{error/error :: form(title)}"></div>

                <div class="flex flex-col">
                    <label for="boardClassId">게시판 종류</label>
                    <select name="boardClassId" id="boardClassId" class="select">
                        <option value disabled selected>게시판 종류를 선택해주세요.</option>
                        <option th:each="boardClass : ${boardClasses}"
                                th:value="${boardClass.id}"
                                th:text="${boardClass.className}">
                        </option>
                    </select>
                </div>
                <div th:replace="~{error/error :: form(boardClassId)}"></div>

                <div>
                    <button type="submit" class="btn">제출</button>
                </div>
            </form>

            <script>
                // 뒤로가기로 페이지 접근 방지
                window.onpageshow = function(event) {
                    if (event.persisted || (window.performance && window.performance.navigation.type === 2))
                    {
                        location.replace('/');
                    }
                };

                function checkForm(form)
                {
                    // 게시판 이름 확인
                    form.title.value = form.title.value.trim();
                    const title = form.title;

                    if (title.value === "")
                    {
                        alert("게시판 이름을 입력해주세요.");
                        title.focus();
                        return;
                    }

                    // 게시판 종류 확인
                    form.boardClassId.value = form.boardClassId.value.trim();
                    const boardClassId = form.boardClassId;

                    if (boardClassId.value === "")
                    {
                        alert("게시판 종류를 선택해주세요.");
                        boardClassId.focus();
                        return;
                    }

                    form.submit();
                }
            </script>
        </section>
    </body>
</html>